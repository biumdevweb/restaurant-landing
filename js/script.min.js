const hamburger=document.querySelector(".hamburger"),navMenu=document.querySelector(".nav-menu"),navLinks=document.querySelectorAll(".nav-link"),reservationForm=document.getElementById("reservationForm"),formMessage=document.getElementById("formMessage"),galleryContainer=document.querySelector(".gallery-container"),gallerySlides=document.querySelectorAll(".gallery-slide"),galleryPrev=document.querySelector(".gallery-prev"),galleryNext=document.querySelector(".gallery-next"),galleryIndicators=document.querySelectorAll(".indicator");let currentSlide=0;const totalSlides=gallerySlides.length;function showSlide(e){currentSlide=e<0?totalSlides-1:e>=totalSlides?0:e;const t=100*-currentSlide;galleryContainer.style.transform=`translateX(${t}%)`,galleryIndicators.forEach((e,t)=>{t===currentSlide?e.classList.add("active"):e.classList.remove("active")})}function nextSlide(){showSlide(currentSlide+1)}function prevSlide(){showSlide(currentSlide-1)}function goToSlide(e){showSlide(e)}hamburger.addEventListener("click",()=>{hamburger.classList.toggle("active"),navMenu.classList.toggle("active")}),navLinks.forEach(e=>{e.addEventListener("click",()=>{hamburger.classList.remove("active"),navMenu.classList.remove("active")})}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();const t=document.querySelector(this.getAttribute("href"));t&&t.scrollIntoView({behavior:"smooth",block:"start"})})}),galleryPrev&&galleryPrev.addEventListener("click",prevSlide),galleryNext&&galleryNext.addEventListener("click",nextSlide),galleryIndicators&&galleryIndicators.forEach((e,t)=>{e.addEventListener("click",()=>goToSlide(t))});let galleryInterval,touchStartX=0,touchEndX=0;function handleSwipe(){const e=touchStartX-touchEndX;Math.abs(e)>50&&(e>0?nextSlide():prevSlide())}function startGalleryAutoPlay(){galleryInterval=setInterval(nextSlide,5e3)}function stopGalleryAutoPlay(){clearInterval(galleryInterval)}function isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function isValidPhone(e){return/^[\d\s\-\+\(\)]+$/.test(e)&&e.replace(/\D/g,"").length>=8}function showFormMessage(e,t){formMessage.textContent=e,formMessage.className=`form-message ${t}`,formMessage.style.display="block",formMessage.scrollIntoView({behavior:"smooth",block:"nearest"}),setTimeout(()=>{formMessage.style.display="none"},5e3)}function simulateReservationSubmission(e){showFormMessage("Elaborazione prenotazione in corso...","info"),setTimeout(()=>{reservationForm.reset(),showFormMessage(`Grazie ${e.name}! La tua prenotazione per ${e.guests} persone il ${formatDate(e.date)} alle ${e.time} è stata confermata. Ti abbiamo inviato una email di conferma a ${e.email}.`,"success"),console.log("Reservation data submitted:",e)},1500)}function formatDate(e){return new Date(e).toLocaleDateString("it-IT",{day:"2-digit",month:"2-digit",year:"numeric"})}galleryContainer&&(galleryContainer.addEventListener("touchstart",e=>{touchStartX=e.changedTouches[0].screenX},{passive:!0}),galleryContainer.addEventListener("touchend",e=>{touchEndX=e.changedTouches[0].screenX,handleSwipe()},{passive:!0})),galleryContainer&&(startGalleryAutoPlay(),galleryContainer.addEventListener("mouseenter",stopGalleryAutoPlay,{passive:!0}),galleryContainer.addEventListener("mouseleave",startGalleryAutoPlay,{passive:!0}),galleryContainer.addEventListener("touchstart",stopGalleryAutoPlay,{passive:!0}),galleryContainer.addEventListener("touchend",startGalleryAutoPlay,{passive:!0})),reservationForm&&reservationForm.addEventListener("submit",function(e){e.preventDefault();const t=document.getElementById("name").value.trim(),r=document.getElementById("email").value.trim(),n=document.getElementById("phone").value.trim(),o=document.getElementById("date").value,a=document.getElementById("time").value,s=document.getElementById("guests").value,l=document.getElementById("requests").value.trim();if(!(t&&r&&n&&o&&a&&s))return void showFormMessage("Per favore, compila tutti i campi obbligatori.","error");if(!isValidEmail(r))return void showFormMessage("Per favore, inserisci un indirizzo email valido.","error");if(!isValidPhone(n))return void showFormMessage("Per favore, inserisci un numero di telefono valido.","error");const i=new Date(o),c=new Date;c.setHours(0,0,0,0),i<c?showFormMessage("La data di prenotazione non può essere nel passato.","error"):simulateReservationSubmission({name:t,email:r,phone:n,date:o,time:a,guests:s,requests:l})}),document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("date");if(e){const t=(new Date).toISOString().split("T")[0];e.setAttribute("min",t)}gallerySlides.length>0&&showSlide(0);const t=document.getElementById("current-year");t&&(t.textContent=(new Date).getFullYear())});const observerOptions={threshold:.1,rootMargin:"0px 0px -50px 0px"},observer=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.style.opacity="1",e.target.style.transform="translateY(0)")})},observerOptions);function isInViewport(e){const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".menu-category, .gallery-carousel, .about-text, .reservation-info, .contact-info").forEach(e=>{e.style.opacity="0",e.style.transform="translateY(20px)",e.style.transition="opacity 0.6s ease, transform 0.6s ease",observer.observe(e)})}),window.addEventListener("scroll",()=>{const e=document.querySelector(".header");window.scrollY>100?e.style.backgroundColor="rgba(255, 255, 255, 0.98)":e.style.backgroundColor="rgba(255, 255, 255, 0.95)"},{passive:!0}),document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelectorAll("img[data-src]");if("IntersectionObserver"in window){const t=new IntersectionObserver((e,r)=>{e.forEach(e=>{if(e.isIntersecting){const r=e.target;r.src=r.dataset.src,r.classList.remove("lazy"),t.unobserve(r)}})});e.forEach(e=>{t.observe(e)})}else e.forEach(e=>{e.src=e.dataset.src})}),window.addEventListener("scroll",()=>{let e="";document.querySelectorAll("section").forEach(t=>{const r=t.offsetTop;t.clientHeight;pageYOffset>=r-200&&(e=t.getAttribute("id"))}),navLinks.forEach(t=>{t.classList.remove("active"),t.getAttribute("href").slice(1)===e&&t.classList.add("active")})},{passive:!0}),document.addEventListener("DOMContentLoaded",()=>{console.log("Osteria della Tradizione website loaded successfully!"),document.addEventListener("keydown",e=>{"ArrowLeft"===e.key?prevSlide():"ArrowRight"===e.key&&nextSlide()},{passive:!0}),document.addEventListener("visibilitychange",()=>{document.hidden?stopGalleryAutoPlay():startGalleryAutoPlay()},{passive:!0})});